# HouseReserv - Телеграм-бот для бронирования домов

Телеграм-бот на Python для управления бронированием объектов недвижимости (домов, квартир и т.д.).

## Возможности

### Функции администратора:
- ✅ Регистрация администратора с контактными данными (телефон, Telegram username)
- ✅ Создание и удаление объектов для бронирования
- ✅ Добавление/изменение текстового описания объектов
- ✅ Добавление фотографий к объектам (до 10 штук)
- ✅ Добавление видео к объектам (до 2 штук)
- ✅ Просмотр статистики бронирований
- ✅ Управление статусом оплаты аванса
- ✅ Изменение контактных данных администратора
- ✅ Просмотр информации о пользователях, которые бронировали объекты

### Функции пользователя:
- ✅ Просмотр списка доступных объектов
- ✅ Получение детальной информации об объекте (описание, фото, видео)
- ✅ Просмотр забронированных дат по каждому объекту
- ✅ Бронирование объектов на конкретные даты или периоды
- ✅ Проверка доступности дат перед бронированием
- ✅ Получение информации о ближайших доступных датах при занятости желаемого периода
- ✅ Просмотр свободных дат
- ✅ Получение контактных данных владельца объекта
- ✅ Отмена своих бронирований
- ✅ Автоматическая отправка уведомлений администраторам о новых бронированиях

## Установка и настройка

### Требования
- Python 3.8+
- Telegram Bot Token (получить у [@BotFather](https://t.me/BotFather))

### Установка зависимостей

```bash
pip install -r requirements.txt
```

### Настройка

1. Создайте файл `.env` в корне проекта со следующим содержимым:
```bash
# Токен бота от @BotFather
BOT_TOKEN=your_bot_token_here

# Путь к базе данных (опционально, по умолчанию house_reserv.db)
DATABASE_PATH=house_reserv.db

# Максимальное количество фотографий на объект (по умолчанию 10)
MAX_PHOTOS=10

# Максимальное количество видео на объект (по умолчанию 2)
MAX_VIDEOS=2

# ID администраторов через запятую (опционально, можно добавить через команду /register_admin)
# Пример: ADMIN_IDS=123456789,987654321
ADMIN_IDS=

# Уровень логирования (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# Формат логов (опционально)
LOG_FORMAT=%(asctime)s - %(name)s - %(levelname)s - %(message)s
```

2. Запустите бота:
```bash
python bot.py
```

## Структура проекта

```
HouseReserv/
├── bot.py                 # Главный файл запуска бота
├── config.py              # Конфигурация и настройки
├── database.py            # Модуль работы с базой данных
├── models.py              # Модели данных
├── admin_handlers.py      # Обработчики команд администратора
├── user_handlers.py       # Обработчики команд пользователя
├── date_utils.py          # Утилиты для работы с датами
├── requirements.txt       # Зависимости проекта
└── README.md              # Документация
```

## Использование

### Для администратора

1. **Регистрация администратора:**
   ```
   /register_admin
   ```

2. **Доступ к панели администратора:**
   ```
   /admin
   ```

3. **Установка контактных данных:**
   ```
   /set_phone +79991234567
   /set_username myusername
   ```

4. **Управление объектами:**
   - Используйте кнопки в меню `/admin` → "Управление объектами"
   - Добавьте объект, затем отправьте название
   - Добавьте описание, фотографии и видео через соответствующие кнопки

### Для пользователя

1. **Начало работы:**
   ```
   /start
   ```

2. **Просмотр объектов:**
   - Нажмите "Список объектов"
   - Выберите интересующий объект

3. **Бронирование:**
   - Нажмите "Забронировать" на странице объекта
   - Введите даты в формате: `DD.MM.YYYY - DD.MM.YYYY`
   - Например: `01.12.2024 - 05.12.2024`

4. **Просмотр своих бронирований:**
   ```
   /my_bookings
   ```

## База данных

Бот использует SQLite для хранения данных. База данных создается автоматически при первом запуске.

Таблицы:
- `admins` - администраторы
- `properties` - объекты недвижимости
- `bookings` - бронирования
- `property_photos` - фотографии объектов
- `property_videos` - видео объектов

## Формат дат

Все даты вводятся и отображаются в формате `DD.MM.YYYY` (например, `01.12.2024`).

## Безопасность

- Только зарегистрированные администраторы могут управлять объектами
- Пользователи могут отменять только свои бронирования
- Проверка доступности дат предотвращает двойное бронирование

## Разработка

Проект разбит на модули для удобства поддержки и расширения:

- `bot.py` - точка входа, настройка обработчиков
- `database.py` - все операции с БД
- `admin_handlers.py` - логика для администраторов
- `user_handlers.py` - логика для пользователей
- `date_utils.py` - вспомогательные функции для работы с датами
- `models.py` - модели данных

## Лицензия

MIT License
